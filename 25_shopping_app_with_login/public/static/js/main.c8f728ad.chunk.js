(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{149:function(e,t,n){},151:function(e,t,n){},160:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),a=n(56),o=n.n(a),c=(n(149),n(27)),i=n.n(c),l=n(62),u=n(16),d=n(17),j=n(19),h=n(18),p=(n.p,n(151),n(83)),b=n(41),g=n(172),O=n(175),m=n(2),x=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onChange=function(e){r.setState(Object(b.a)({},e.target.name,e.target.value))},r.onSubmit=function(e){if(e.preventDefault(),r.state.type){var t=Object(p.a)({},r.state);r.props.addToList(t),r.setState({type:"",count:0,price:0})}},r.state={type:"",count:0,price:0},r}return Object(d.a)(n,[{key:"render",value:function(){return Object(m.jsx)("div",{style:{width:500,margin:"auto",backgroundColor:"lightblue"},children:Object(m.jsxs)(g.a,{onSubmit:this.onSubmit,children:[Object(m.jsxs)(g.a.Field,{children:[Object(m.jsx)("label",{htmlFor:"type",children:"Item Type:"}),Object(m.jsx)("input",{type:"text",name:"type",onChange:this.onChange,value:this.state.type})]}),Object(m.jsxs)(g.a.Field,{children:[Object(m.jsx)("label",{htmlFor:"count",children:"Count:"}),Object(m.jsx)("input",{type:"number",name:"count",onChange:this.onChange,value:this.state.count})]}),Object(m.jsxs)(g.a.Field,{children:[Object(m.jsx)("label",{htmlFor:"price",children:"Price:"}),Object(m.jsx)("input",{type:"number",name:"price",step:"0.01",onChange:this.onChange,value:this.state.price})]}),Object(m.jsx)(O.a,{type:"submit",children:"Add"})]})})}}]),n}(s.a.Component),f=n(177),v=n(173),C=n(59),y=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e={height:120,backgroundColor:"lightblue"};return this.props.isLogged?Object(m.jsxs)("div",{style:e,children:[Object(m.jsx)(f.a,{children:"Shopping App"}),Object(m.jsxs)(v.a,{children:[Object(m.jsx)(v.a.Item,{children:Object(m.jsx)(C.b,{to:"/list",children:"Shopping List"})}),Object(m.jsx)(v.a.Item,{children:Object(m.jsx)(C.b,{to:"/form",children:"Add new item"})}),Object(m.jsx)(v.a.Item,{children:Object(m.jsx)(C.b,{to:"/",onClick:this.props.logout,children:"Logout"})})]})]}):Object(m.jsx)("div",{style:e,children:Object(m.jsx)(f.a,{children:"Shopping App"})})}}]),n}(s.a.Component),S=n(174),k=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(m.jsxs)(S.a.Row,{children:[Object(m.jsx)(S.a.Cell,{children:this.props.item.type}),Object(m.jsx)(S.a.Cell,{children:this.props.item.count}),Object(m.jsx)(S.a.Cell,{children:this.props.item.price}),Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)(O.a,{color:"red",onClick:function(){return e.props.changeToRemoveMode(e.props.index)},children:"Remove"})}),Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)(O.a,{color:"green",onClick:function(){return e.props.changeToEditMode(e.props.index)},children:"Edit"})})]})}}]),n}(s.a.Component),w=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(m.jsxs)(S.a.Row,{children:[Object(m.jsx)(S.a.Cell,{children:this.props.item.type}),Object(m.jsx)(S.a.Cell,{children:this.props.item.count}),Object(m.jsx)(S.a.Cell,{children:this.props.item.price}),Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)(O.a,{color:"grey",onClick:function(){return e.props.cancel()},children:"Cancel"})}),Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)(O.a,{color:"green",onClick:function(){return e.props.removeFromList(e.props.item.id)},children:"Confirm"})})]})}}]),n}(s.a.Component),L=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onChange=function(e){r.setState(Object(b.a)({},e.target.name,e.target.value))},r.onSubmit=function(e){var t=Object(p.a)(Object(p.a)({},r.state),{},{id:r.props.item.id});r.props.editItem(t)},r.state={type:e.item.type,count:e.item.count,price:e.item.price},r}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(m.jsxs)(S.a.Row,{children:[Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)("input",{type:"text",name:"type",onChange:this.onChange,value:this.state.type})}),Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)("input",{type:"number",name:"count",onChange:this.onChange,value:this.state.count})}),Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)("input",{type:"number",name:"price",step:"0.01",onChange:this.onChange,value:this.state.price})}),Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)(O.a,{color:"green",onClick:this.onSubmit,children:"Save"})}),Object(m.jsx)(S.a.Cell,{children:Object(m.jsx)(O.a,{color:"grey",onClick:function(){return e.props.cancel()},children:"Cancel"})})]})}}]),n}(s.a.Component),T=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).changeToRemoveMode=function(e){r.setState({removeIndex:e,editIndex:-1})},r.changeToEditMode=function(e){r.setState({removeIndex:-1,editIndex:e})},r.cancel=function(){r.setState({removeIndex:-1,editIndex:-1})},r.removeFromList=function(e){r.props.removeFromList(e),r.cancel()},r.editItem=function(e){r.props.editItem(e),r.cancel()},r.state={removeIndex:-1,editIndex:-1},r}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=this.props.list.map((function(t,n){return e.state.removeIndex===n?Object(m.jsx)(w,{item:t,removeFromList:e.removeFromList,cancel:e.cancel},t.id):e.state.editIndex===n?Object(m.jsx)(L,{item:t,editItem:e.editItem,cancel:e.cancel},t.id):Object(m.jsx)(k,{item:t,index:n,changeToRemoveMode:e.changeToRemoveMode,changeToEditMode:e.changeToEditMode},t.id)}));return Object(m.jsxs)(S.a,{striped:!0,children:[Object(m.jsxs)(S.a.Header,{children:[Object(m.jsx)(S.a.HeaderCell,{children:"Item type"}),Object(m.jsx)(S.a.HeaderCell,{children:"Count"}),Object(m.jsx)(S.a.HeaderCell,{children:"Price"}),Object(m.jsx)(S.a.HeaderCell,{children:"Remove"}),Object(m.jsx)(S.a.HeaderCell,{children:"Edit"})]}),Object(m.jsx)(S.a.Body,{children:t})]})}}]),n}(s.a.Component),I=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onChange=function(e){r.setState(Object(b.a)({},e.target.name,e.target.value))},r.onSubmit=function(e){if(r.state.username.length<4||r.state.password.length<8)alert("Username must be atleast four and password atleast eight characters long");else{var t={username:r.state.username,password:r.state.password};"register"===e.target.name?r.props.register(t):r.props.login(t)}},r.state={username:"",password:""},r}return Object(d.a)(n,[{key:"render",value:function(){return Object(m.jsx)("div",{style:{width:500,margin:"auto",backgroundColor:"lightblue"},children:Object(m.jsxs)(g.a,{children:[Object(m.jsxs)(g.a.Field,{children:[Object(m.jsx)("label",{htmlFor:"username",children:"Username:"}),Object(m.jsx)("input",{type:"text",name:"username",onChange:this.onChange,value:this.state.username})]}),Object(m.jsxs)(g.a.Field,{children:[Object(m.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(m.jsx)("input",{type:"password",name:"password",onChange:this.onChange,value:this.state.password})]}),Object(m.jsx)(O.a,{onClick:this.onSubmit,name:"register",children:"Register"}),Object(m.jsx)(O.a,{onClick:this.onSubmit,name:"login",children:"Login"})]})})}}]),n}(s.a.Component),F=n(10),E=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).clearState=function(){r.setState({list:[],isLogged:!1,token:""},(function(){r.saveToStorage()}))},r.saveToStorage=function(){sessionStorage.setItem("state",JSON.stringify(r.state))},r.register=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(t)},e.next=3,fetch("/register",n).catch((function(e){console.log("There was an error:"+e)}));case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:r.ok?alert("Register success"):(409===r.status&&console.log("Username is already in use"),console.log("Server responded with a status:"+r.status));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.login=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,s,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(t)},e.next=3,fetch("/login",n).catch((function(e){console.log("There was an error:"+e)}));case 3:if(s=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(!s.ok){e.next=16;break}return e.next=9,s.json().catch((function(e){console.log("Error parsing json:"+e)}));case 9:if(a=e.sent){e.next=13;break}return console.log("Failed to parse json"),e.abrupt("return");case 13:r.setState({isLogged:!0,token:a.token},(function(){r.saveToStorage(),r.getList()})),e.next=17;break;case 16:console.log("Server responded with a status:"+s.status);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.logout=Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",mode:"cors",headers:{"Content-type":"application/json",token:r.state.token}},e.next=3,fetch("/logout",t).catch((function(e){console.log("There was an error"),r.clearState()}));case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:n.ok?r.clearState():(r.clearState(),console.log("Server responded with a status:"+n.status));case 7:case"end":return e.stop()}}),e)}))),r.getList=function(){var e={method:"GET",mode:"cors",headers:{"Content-type":"application/json",token:r.state.token}};fetch("/api/shopping",e).then((function(e){e.ok?e.json().then((function(e){r.setState({list:e},(function(){r.saveToStorage()}))})).catch((function(e){console.log("Failed to parse JSON, reason:"+e)})):(403===e.status&&(console.log("Session has expired. Logging out!"),r.clearState()),console.log("Server responded with a status:"+e.status))})).catch((function(e){console.log(e)}))},r.addToList=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",mode:"cors",headers:{"Content-type":"application/json",token:r.state.token},body:JSON.stringify(t)},e.next=3,fetch("/api/shopping",n).catch((function(e){return console.log(e)}));case 3:if(s=e.sent){e.next=6;break}return e.abrupt("return");case 6:s.ok?r.getList():(403===s.status&&(console.log("Session has expired. Logging out!"),r.clearState()),console.log("Failed to add to list. Server responded with a status:"+s.status));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.removeFromList=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"DELETE",mode:"cors",headers:{"Content-type":"application/json",token:r.state.token}},e.next=3,fetch("/api/shopping/"+t,n).catch((function(e){return console.log(e)}));case 3:if(s=e.sent){e.next=6;break}return e.abrupt("return");case 6:s.ok?r.getList():(403===s.status&&(console.log("Session has expired. Logging out!"),r.clearState()),console.log("Failed to remove from list. Server responded with a status:"+s.status));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.editItem=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"PUT",mode:"cors",headers:{"Content-type":"application/json",token:r.state.token},body:JSON.stringify(t)},e.next=3,fetch("/api/shopping/"+t.id,n).catch((function(e){return console.log(e)}));case 3:if(s=e.sent){e.next=6;break}return e.abrupt("return");case 6:s.ok?r.getList():(403===s.status&&(console.log("Session has expired. Logging out!"),r.clearState()),console.log("Failed to edit item. Server responded with a status:"+s.status));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.state={list:[],isLogged:!1,token:""},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;if(sessionStorage.getItem("state")){var t=JSON.parse(sessionStorage.getItem("state"));this.setState(t,(function(){e.state.isLogged&&e.getList()}))}}},{key:"render",value:function(){var e=this;return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(y,{logout:this.logout,isLogged:this.state.isLogged}),Object(m.jsx)("hr",{}),Object(m.jsxs)(F.d,{children:[Object(m.jsx)(F.b,{exact:!0,path:"/",render:function(){return e.state.isLogged?Object(m.jsx)(F.a,{to:"/list"}):Object(m.jsx)(I,{register:e.register,login:e.login})}}),Object(m.jsx)(F.b,{path:"/list",render:function(){return e.state.isLogged?Object(m.jsx)(T,{list:e.state.list,removeFromList:e.removeFromList,editItem:e.editItem}):Object(m.jsx)(F.a,{to:"/"})}}),Object(m.jsx)(F.b,{path:"/form",render:function(){return e.state.isLogged?Object(m.jsx)(x,{addToList:e.addToList}):Object(m.jsx)(F.a,{to:"/"})}}),Object(m.jsx)(F.b,{render:function(){return e.state.isLogged?Object(m.jsx)(F.a,{to:"list"}):Object(m.jsx)(F.a,{to:"/"})}})]})]})}}]),n}(s.a.Component),R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,178)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),s(e),a(e),o(e)}))};n(159);o.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(C.a,{children:Object(m.jsx)(E,{})})}),document.getElementById("root")),R()}},[[160,1,2]]]);
//# sourceMappingURL=main.c8f728ad.chunk.js.map